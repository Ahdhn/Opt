\newcommand{\FigAppSummary}{
\begin{figure*}[t]
  \vspace{1.5in}
  \JRK{Grid of representative app images, code size, and performance vs. CUDA and cuSPARSE implementations}
  \vspace{1.5in}
  \caption{\TODO{In \OPT, you need far less code and the result runs as fast as state-of-the-art hand-written solvers}}
  \label{fig:app_summary}
\end{figure*}
}

\newcommand{\FigJTJAlgorithm}{
\begin{figure}[t]
  %\includegraphics[width=0.6\linewidth]{figures/jtj_pseudocode.pdf}
  $\hat{P} = 0$\\[4pt]
  $\mathit{cols} = \{\}$\\[4pt]
  $\mathbf{for}\ r_i\ \mathbf{in}\ \mathrm{r}_\mathrm{deps}(x(0,0)):$\\[4pt]
  \TAB $\frac{\diff r_i}{\diff x(0,0)} = \mathrm{autodiff}(r_i, x(0,0))$\\[4pt]
  \TAB $\mathbf{for}\ x_i\ \mathbf{in}\ \mathrm{x}_\mathrm{deps}(r_i):$\\[4pt]
  \TAB\TAB $\frac{\diff r_i}{\diff x_i} = \mathrm{autodiff}(r_i, x_i)$\\[4pt]
  \TAB\TAB $e = \frac{\diff r_i}{\diff x(0,0)} \times \frac{\diff r_i}{\diff x_i}$\\[4pt]
  \TAB\TAB $\mathbf{if}\ x_i\ \mathbf{not\ in} \mathit{cols}:$\\[4pt]
  \TAB\TAB\TAB $\mathit{cols}[x_i] = 0$\\[4pt]
  \TAB\TAB $\mathit{cols}[x_i] \mathrel{+}= e$\\[4pt]
  $\mathbf{for}\ c,e\ \mathbf{in}\ \mathit{cols}:$\\[4pt] 
  \TAB $\hat{P} \mathrel{+}= P(c)\times e$\\[4pt]
  $\mathbf{return}\ \hat{P}\times 2$
  \caption{\JRK{algorithm for computing JTJp}}
  \label{fig:jtj_algorithm}
\end{figure}
}

